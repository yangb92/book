# 单片机 MCU(Micro Controller Unit)

## 型号解释

`STC 89C52 35I-PDIP40 1749HRX921..`

* STC：公司名称
* 89：89系列
* C：CMOS
* 52：stc还有51，54，58，516后面的值*4k表示内存空间的大小。52的内存空间为8k。
* 35：表示单品机的工作频率
* I：表示工业级（-40 - 125摄氏度）， C表示商业级（温度范围0-80）军品级别
* PDIP：封装型号，包括单片机的形状和大小。
* 1749：代表生产时间，17年4月9日

## 80C51引脚封装

* 总线型
* 非总线型

总线分为三种：数据总线DB(Data Bus),地址总线AB(Adress Bus),控制总线CB(Control Bus)

## 单片机组成

* CPU
* RAM
* ROM
* I/O
* T/C ：两个定时/计数器，既可以工作在定时模式，也可工作在计数模式。

## C51 知识

很多硬件的开发都使用C语言编程，例如各种单片机，DSP，ARM等。

## C51 数据类型

### C-51基础数据类型

  (有符号和无符号字节数 signed,unsigned) 
  int(16) short(16) long(32) float(32) double(64) char(8) 

### C51 数据类型扩充定义

* sfr: 特殊功能寄存器申明
* sfr16: sfr的16位数据申明
* sbit: 特殊功能位声明
* bit：位变量声明

### C51 包含的头文件

常用头文件有

reg51.h reg52.h,定义特殊功能寄存器和位寄存器

math.h 定义常用数学运算

### C51运算符

与C语言基本相同。

算数运算符 + - * / 

布尔运算符：  \> \>= \< \<= == != 

逻辑运算符： && || !

位运算:

* \>\> \<\< 位左移与位右移
* & | 按位与或
* ～ ^ 按位异或 取反 

## C51 基本语句

与C基本相同 if while for switch/case do-while

### 中断服务程序



### I/O口定义



## 单片机要点掌握

* 最小系统能够运行起来的必要条件，1 电源 2 晶振 3 复位电路
* 对单片机任意I/O口的随意操作
  * 输出控制的电频高低
  * 输入检测电频高低
* 定时器
* 中断：外部中断，定时器中断，串口中断
* 串口通信：单片机之间，单片机与计算机间



## 单片机工作的基本时序

1. 振荡周期: 也称时钟周期,指为单片机提供时钟脉冲信号振荡源的周期, TX实验板为11.0592MHZ
2. 状态周期: 每个状态周期为时钟周期的两倍,是振荡周期经二分频后得到的.
3. 机器周期: 一个机器周期包含6个状态周期,也就是12个时钟周期,在一个机器周期内,CPU可以完成一个独立的操作,
4. 指令周期: 它指CPU完成一条操作所需的全部时间,每条指令执行时间都是有一个或几个机器周期组成 MCS-51系统中,有单周期指令,双周期指令和四周期指令.



## 80C51引脚封装

80C51/89C51 最大4k程序. 

管脚:

* RST/Vpd:  复位/备用电源的输入端, 
* P3.0/RXD, P3.1/TXD,P3.2/INTO ... P3.7/RD:  串口,程序下载命令,中断,定时器,计数器,外部数据存储器.
* XTAL2 XTAL1: 外部晶振输入端.
* ALE



## 中断

### 中断的概念: 

CPU 在处理某一事件A, 发生了另一事件B请求CPU迅速去处理(**中断发生**)

CPU暂时中断当前的工作,转去处理事件B(**中断响应和中断服务**)

待CPU将事件B处理完毕后,再回到原来事件A被中断的地方继续处理事件A(**中断返回**),这一过程称为**中断**



### 中断的嵌套

在中断服务中再次发生中断



### 中断的优先级

中断源的响应优先级及中端服务入口程序表

| 中断源             | 中断标志 | 中断服务程序入口 | 优先级顺序 |
| ------------------ | -------- | ---------------- | ---------- |
| 外部中断 0 (INT0)  | IE0      | 0003H            | 高         |
| 定时/计数器 0 (T0) | TF0      | 000BH            | ⬇          |
| 外部中断 1 (INT1)  | IE1      | 0013H            | ⬇          |
| 定时/计数器 1(T1)  | TF1      | 001BH            | ⬇          |
| 串行口             | RI或T1   | 0023H            | 低         |



### 中断响应条件

1. 中断源有中断请求
2. 此中断源的中断允许位为1
3. CPU开中断 即 EA=1









